### Документация Nimble Exporter

#### Обзор

**Nimble Exporter** - приложение, разработанное для мониторинга серверов Nimble SRT (Secure Reliable Transport). Экспортер собирает метрики с конечных точек Nimble SRT, таких как статистика отправителей и получателей, и делает их доступными в формате [Prometheus](https://prometheus.io/) для удобного мониторинга и визуализации.

#### Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/trublast/nimble-exporter
   cd nimble-exporter
   ```

1. Соберите экспортер:
   ```bash
   go build -o nimble_exporter
   ```

1. Соберите Docker-образ:
   ```bash
   docker build -t nimble-exporter .
   ```

1. Запустите контейнер:
   ```bash
   docker run -d -p 9017:9017 nimble-exporter
   ```

#### Конфигурация

Для настройки конфигурации используются параметры:
- `-listen`: адрес для привязки экспортера (по умолчанию `:9017`).
- `-nimble`: адрес сервера Nimble SRT (по умолчанию `http://127.0.0.1:8082`).
- `-auth_salt`: соль (модификатор входа хеш-функции) для аутентификации, если требуется.
- `-auth_hash`: хеш для аутентификации, если требуется.

Пример использования:

```bash
./nimble_exporter -listen ":9017" -nimble "http://ваш_nimble_адрес" -auth_salt "590" -auth_hash "xxxx"
```

#### Логирование

Для логирования используются параметры:
- `-loglevel`: уровень логирования (`info`, `debug`, `error` и т.д.).
- `-logfmt`: формат логов (`normal`, `json`).`-loglevel` и `-logfmt`.

#### Экспортируемые метрики

##### Метрики отправителей SRT
- **Время**: время работы отправителя в секундах.
- **Окно: поток, задержка, занятость**: метрики окна SRT, связанные с контролем потока.
- **RTT**: время задержки при круговом обходе.
- **Пропускная способность**: текущая пропускная способность в Мбит/с.
- **Пакеты**: статистика по принятым, потерянным, сброшенным и повторно отправленным пакетам.
- **Байты**: статистика по принятым, потерянным, сброшенным и повторно отправленным байтам.

##### Метрики получателей SRT
- **Время**: время работы получателя в секундах.
- **Окно: поток, задержка, занятость**: Метрики окна SRT, связанные с контролем потока.
- **RTT**: время задержки при круговом обходе.
- **Пропускная способность**: текущая пропускная способность в Мбит/с.
- **Пакеты**: статистика по принятым, потерянным, сброшенным и повторно отправленным пакетам.
- **Байты**: статистика по принятым, потерянным, сброшенным и повторно отправленным байтам.

##### Метрики состояния сервера
- **Подключения**: количество активных подключений.
- **Исходящий трафик**: скорость исходящего трафика.
- **Размеры кеша RAM/файлов**: текущие и максимальные размеры кеша RAM и файлов.
- **Системная информация**: различные системные метрики, включая ap, scl, tpms и другие.



