### Документация Nimble Exporter

#### Обзор

**Nimble Exporter** - приложение, разработанное для мониторинга серверов Nimble SRT (Secure Reliable Transport). Экспортер собирает метрики с конечных точек Nimble SRT, таких как статистика отправителей и получателей, и делает их доступными в формате [Prometheus](https://prometheus.io/) для удобного мониторинга и визуализации.

#### Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/trublast/nimble-exporter
   cd nimble-exporter
   ```

1. Соберите экспортер:
   ```bash
   go build -o nimble_exporter
   ```

1. Соберите Docker-образ:
   ```bash
   docker build -t nimble-exporter .
   ```

1. Запустите контейнер:
   ```bash
   docker run -d -p 9017:9017 nimble-exporter
   ```

#### Конфигурация

Для настройки конфигурации используются параметры:
- `-listen`: Адрес для привязки экспортера (по умолчанию `:9017`).
- `-nimble`: Адрес сервера Nimble SRT (по умолчанию `http://127.0.0.1:8082`).
- `-auth_salt`: Соль (модификатор входа хеш-функции) для аутентификации, если требуется.
- `-auth_hash`: Хеш для аутентификации, если требуется.
- `-loglevel`: Уровень логирования (`info`, `debug`, `error` и т.д.).
- `-logfmt`: Формат логов (`normal`, `json`).

Пример использования:

```bash
./nimble_exporter -listen ":9017" -nimble "http://ваш_nimble_адрес" -auth_salt "590" -auth_hash "xxxx"
```

### Логирование

Приложение поддерживает логирование, его можно настроить с помощью параметров `-loglevel` и `-logfmt`.

#### Экспортируемые метрики

##### Метрики отправителей SRT
- **Время**: Время работы отправителя в секундах.
- **Окно: Поток, Задержка, Занятость**: Метрики окна SRT, связанные с контролем потока.
- **RTT**: Время задержки при круговом обходе.
- **Пропускная способность**: Текущая пропускная способность в Мбит/с.
- **Пакеты**: Статистика по принятым, потерянным, сброшенным и повторно отправленным пакетам.
- **Байты**: Статистика по принятым, потерянным, сброшенным и повторно отправленным байтам.

##### Метрики получателей SRT
- **Время**: Время работы получателя в секундах.
- **Окно: Поток, Задержка, Занятость**: Метрики окна SRT, связанные с контролем потока.
- **RTT**: Время задержки при круговом обходе.
- **Пропускная способность**: Текущая пропускная способность в Мбит/с.
- **Пакеты**: Статистика по принятым, потерянным, сброшенным и повторно отправленным пакетам.
- **Байты**: Статистика по принятым, потерянным, сброшенным и повторно отправленным байтам.

##### Метрики состояния сервера
- **Подключения**: Количество активных подключений.
- **Исходящий трафик**: Скорость исходящего трафика.
- **Размеры кеша RAM/файлов**: Текущие и максимальные размеры кеша RAM и файлов.
- **Системная информация**: Различные системные метрики, включая ap, scl, tpms и другие.



